subconsulta
===========

subconsultas

USE VENTASCIB

SELECT COD_VEN, NOM_VEN 
      FROM TB_VENDEDOR
	  WHERE COD_VEN IN (SELECT COD_VEN
	                    FROM TB_FACTURA
						WHERE NUM_FAC='FA003')

----- ELABORE UNA CONSULTA QUE MUESTRE COD_PROV,RAZ_SOC_PRV QUE PROVEA EL PRODUCTO CON CODIGO P001

   SELECT COD_PRV,RAZ_SOC_PRV
      FROM TB_PROVEEDOR
	  WHERE COD_PRV IN (SELECT COD_PRV
	                    FROM TB_ABASTECIMIENTO
						WHERE COD_PRO='P001')

----ELABORE CONSULTA QUE MUESTRE LOS COD_CLI RAZ_SOC_CLI DIR_CLI DE TODOS LOS CLIENTES QUE VIVAN EL EL DISTRITO SAN BORJA

   SELECT COD_CLI,RAZ_SOC_CLI,DIR_CLI
          FROM TB_CLIENTE
		  WHERE COD_DIS IN(SELECT COD_DIS
		                   FROM TB_DISTRITO
						   WHERE NOM_DIS LIKE 'SAN BORJA')
 


 SELECT *
    FROM TB_PRODUCTO
	WHERE PRE_PRO > ANY(SELECT PRE_VEN
	                    FROM TB_DETALLE_FACTURA
						WHERE CAN_VEN>30)




 SELECT *
    FROM TB_PROVEEDOR P
	WHERE NOT EXISTS (SELECT * 
	              FROM TB_ABASTECIMIENTO
				  WHERE COD_PRV=P.COD_PRV)



----ELABORAR CONSULTA QUE MUESTRE NUM_FAC FEC_FAC DES_PRO PRE_VEN CAN_VEN
     ALTER VIEW V_FACTURA_PRODUCTO
	 AS
	      
	 SELECT F.NUM_FAC,FEC_FAC,DES_PRO,PRE_VEN,CAN_VEN
	 FROM TB_FACTURA F INNER JOIN TB_DETALLE_FACTURA DF
	 ON F.NUM_FAC=DF.NUM_FAC
	                 INNER JOIN TB_PRODUCTO P
		ON DF.COD_PRO=P.COD_PRO

		SELECT * FROM V_FACTURA_PRODUCTO
        WHERE CAN_VEN>30

		-----CREAR UNA VISTA QUE MUESTRE COD_CLI ,RAZ_SOC_CLI,NUM_FAC,FEC_FAC

		CREATE VIEW V_CLIENTE_FACTURA
		AS
		SELECT C.COD_CLI,RAZ_SOC_CLI,NUM_FAC,FEC_FAC
		FROM TB_CLIENTE C INNER JOIN TB_FACTURA F
		ON C.COD_CLI=F.COD_CLI

		SELECT * FROM V_CLIENTE_FACTURA


		---ELABORAR LA CONSULTA QUE MUESTRE LO SIGUIENTE: NUM_FAC,DES_PRO,PRE_VEN,RAZ_SOC_PRV

		SELECT NUM_FAC,DES_PRO,PRE_VEN,RAZ_SOC_PRV
		 FROM V_FACTURA_PRODUCTO V INNER JOIN TB_ABASTECIMIENTO A
		 ON V.COD_PRO=A.COD_PRO
		                       INNER JOIN TB_PROVEEDOR P
	     ON A.COD_PRV=P.COD_PRV
